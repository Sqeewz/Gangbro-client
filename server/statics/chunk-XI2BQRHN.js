import{$ as V,Z as A,ba as N,f as k,fa as F,ga as L,ha as D,ia as z,ja as R,ka as $,la as B,ma as Y,na as v,o as I,oa as M}from"./chunk-LXLSXBKB.js";import{Bb as w,Cb as O,Db as S,Eb as n,Fb as r,Gb as E,Kb as x,Ob as _,Qb as c,Ua as l,_ as p,_b as h,ac as T,bc as P,cc as a,da as m,dc as b,ea as g,hb as y,pa as C,xb as f,yb as u}from"./chunk-WFEKMZS2.js";var U=(o,t)=>t.id;function H(o,t){o&1&&(n(0,"div",4),E(1,"div",10),n(2,"p"),a(3,"SYNCING SATELLITE DATA..."),r()())}function X(o,t){o&1&&(n(0,"div",5)(1,"p"),a(2,"NO ACTIVE MISSIONS LOGGED IN SYSTEM"),r()())}function q(o,t){o&1&&(n(0,"div",13),a(1,"CHIEF"),r())}function J(o,t){if(o&1){let e=x();n(0,"button",26),_("click",function(){m(e);let s=c(2).$implicit,d=c(2);return g(d.onStart(s.id))}),a(1,"START MISSION"),r(),n(2,"button",27),_("click",function(){m(e);let s=c(2).$implicit,d=c(2);return g(d.onEdit(s))}),a(3,"EDIT"),r(),n(4,"button",28),_("click",function(){m(e);let s=c(2).$implicit,d=c(2);return g(d.onDelete(s.id))}),a(5,"DELETE"),r()}}function K(o,t){if(o&1){let e=x();n(0,"button",26),_("click",function(){m(e);let s=c(2).$implicit,d=c(2);return g(d.onComplete(s.id))}),a(1,"COMPLETE"),r(),n(2,"button",28),_("click",function(){m(e);let s=c(2).$implicit,d=c(2);return g(d.onFail(s.id))}),a(3,"FAIL"),r()}}function Q(o,t){if(o&1&&(n(0,"div",24),f(1,J,6,0),f(2,K,4,0),r()),o&2){let e=c().$implicit;l(),u(e.status==="Open"?1:-1),l(),u(e.status==="InProgress"?2:-1)}}function W(o,t){if(o&1){let e=x();n(0,"button",29),_("click",function(){m(e);let s=c().$implicit,d=c(2);return g(d.onLeave(s.id))}),a(1,"LEAVE MISSION"),r()}}function Z(o,t){if(o&1){let e=x();n(0,"div",12),f(1,q,2,0,"div",13),n(2,"div",14)(3,"h3",15),a(4),r(),n(5,"span",16),a(6),r()(),n(7,"p",17),a(8),r(),n(9,"div",18)(10,"div",19)(11,"span",20),a(12,"CATEGORY"),r(),n(13,"span",21),a(14),r()(),n(15,"div",19)(16,"span",20),a(17,"CHIEF"),r(),n(18,"span",21),a(19),r()()(),n(20,"div",22)(21,"button",23),_("click",function(){let s=m(e).$implicit,d=c(2);return g(d.onViewAbout(s.id))}),a(22,"OPERATIONAL INTEL"),r(),f(23,Q,3,2,"div",24)(24,W,2,0,"button",25),r()()}if(o&2){let e=t.$implicit,i=c(2);T("chief-card",i.isChief(e)),l(),u(i.isChief(e)?1:-1),l(3),b(e.name),l(),P(e.status),l(),b(e.status),l(2),b(e.description||"No operational intel provided."),l(6),b(e.category||"GENERAL"),l(5),b(i.isChief(e)?"YOU":e.chief_display_name),l(4),u(i.isChief(e)?23:24)}}function ee(o,t){if(o&1&&(n(0,"div",6),w(1,Z,25,11,"div",11,U),r()),o&2){let e=c();l(),O(e.missions())}}var j=class o{_missionService=p(L);_passportService=p(V);_dialog=p(N);_router=p(I);_snackBar=p(B);missions=C([]);isLoading=C(!0);myId=C(void 0);constructor(){this.myId.set(this._passportService.data()?.user_id),this.loadMissions()}onViewAbout(t){this._router.navigate(["/about-mission",t])}isChief(t){return t.chief_id===this.myId()}async loadMissions(){try{this.isLoading.set(!0);let t=await this._missionService.getMyMissions();this.missions.set(t.filter(e=>e.status!=="Completed"&&e.status!=="Failed"))}catch(t){console.error("Error loading my missions",t)}finally{this.isLoading.set(!1)}}onAdd(){this._dialog.open(v).afterClosed().subscribe(async e=>{e&&this.performAction(async()=>{await this._missionService.add(e)})})}async onLeave(t){this._dialog.open(M,{data:{title:"ABANDON MISSION",message:"Are you sure you want to leave this mission?",confirmText:"LEAVE",type:"danger"}}).afterClosed().subscribe(i=>{i&&this.performAction(()=>this._missionService.leave(t))})}async onStart(t){this._dialog.open(M,{data:{title:"START OPERATION",message:"Begin this mission and notify the crew?",confirmText:"EXECUTE",type:"info"}}).afterClosed().subscribe(i=>{i&&this.performAction(()=>this._missionService.start(t))})}async onComplete(t){this._dialog.open(M,{data:{title:"MISSION SUCCESS",message:"Has the objective been fully achieved?",confirmText:"COMPLETE",type:"info"}}).afterClosed().subscribe(i=>{i&&this.performAction(()=>this._missionService.complete(t))})}async onFail(t){this._dialog.open(M,{data:{title:"MISSION FAILURE",message:"Mark this mission as failed? This will be logged.",confirmText:"FAIL",type:"danger"}}).afterClosed().subscribe(i=>{i&&this.performAction(()=>this._missionService.fail(t))})}async onDelete(t){this._dialog.open(M,{data:{title:"TERMINATE MISSION",message:"Delete this mission? This action cannot be undone.",confirmText:"DELETE",type:"danger"}}).afterClosed().subscribe(i=>{i&&this.performAction(()=>this._missionService.delete(t))})}onEdit(t){this._dialog.open(v,{data:t}).afterClosed().subscribe(async i=>{i&&this.performAction(()=>this._missionService.update(t.id,i))})}async performAction(t){try{await t(),await this.loadMissions()}catch(e){console.error("Action failed",e);let i=e?.error||e?.message||"Action failed";this._snackBar.open(i,"Close",{duration:3e3})}}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=y({type:o,selectors:[["app-my-missions"]],decls:14,vars:2,consts:[["menuTrigger","matMenuTrigger"],["menu","matMenu"],[1,"my-missions-container"],[1,"gang-title"],[1,"loading-state"],[1,"empty-state"],[1,"mission-grid"],[1,"fab-add-btn",3,"mouseenter","matMenuTriggerFor"],["panelClass","gang-menu",1,"gang-menu"],["mat-menu-item","",3,"click"],[1,"spinner"],[1,"mission-card",3,"chief-card"],[1,"mission-card"],[1,"chief-tag"],[1,"card-header"],[1,"mission-name"],[1,"status-badge"],[1,"description"],[1,"mission-details"],[1,"detail-item"],[1,"label"],[1,"value"],[1,"actions-group"],[1,"gang-btn","secondary","sm","full-width","mb-1",3,"click"],[1,"chief-actions"],[1,"gang-btn","danger","sm","full-width"],[1,"gang-btn","sm",3,"click"],[1,"gang-btn","secondary","sm",3,"click"],[1,"gang-btn","danger","sm",3,"click"],[1,"gang-btn","danger","sm","full-width",3,"click"]],template:function(e,i){if(e&1){let s=x();n(0,"div",2)(1,"h1",3),a(2,"ACTIVE OPERATIONS"),r(),f(3,H,4,0,"div",4)(4,X,3,0,"div",5)(5,ee,3,0,"div",6),n(6,"button",7,0),_("mouseenter",function(){m(s);let G=h(7);return g(G.openMenu())}),a(8,"+"),r(),n(9,"mat-menu",8,1)(11,"button",9),_("click",function(){return m(s),g(i.onAdd())}),n(12,"span"),a(13,"Create New Mission"),r()()()()}if(e&2){let s=h(10);l(3),u(i.isLoading()?3:i.missions().length===0?4:5),l(3),S("matMenuTriggerFor",s)}},dependencies:[k,$,z,D,R,A,Y,F],styles:['.mb-1[_ngcontent-%COMP%]{margin-bottom:.5rem}.my-missions-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:2rem;font-family:Oxanium,sans-serif}.gang-title[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:800;text-transform:uppercase;letter-spacing:2px;background:var(--gang-gradient-main);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:2rem}.mission-grid[_ngcontent-%COMP%]{display:grid;gap:2rem;grid-template-columns:repeat(auto-fill,minmax(350px,1fr))}.mission-card[_ngcontent-%COMP%]{background:var(--gang-surface);border:1px solid var(--gang-border);padding:1.5rem;border-radius:12px;position:relative;overflow:hidden;transition:all .3s cubic-bezier(.4,0,.2,1);display:flex;flex-direction:column;box-shadow:0 10px 30px #0000004d}.mission-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);border-color:var(--gang-primary);box-shadow:0 15px 40px #7c4dff26}.mission-card.chief-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:4px;height:100%;background:var(--gang-accent);box-shadow:0 0 10px var(--gang-accent)}.chief-tag[_ngcontent-%COMP%]{position:absolute;top:0;right:0;background:var(--gang-accent);color:#000;font-size:.65rem;font-weight:800;padding:2px 10px;border-bottom-left-radius:8px;letter-spacing:1px}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1rem}.card-header[_ngcontent-%COMP%]   .mission-name[_ngcontent-%COMP%]{margin:0;font-size:1.4rem;font-weight:700;color:#fff;text-transform:uppercase;line-height:1.2;flex:1;padding-right:1rem}.status-badge[_ngcontent-%COMP%]{font-size:.7rem;padding:3px 10px;border-radius:4px;font-weight:700;text-transform:uppercase;letter-spacing:1px}.status-badge.Open[_ngcontent-%COMP%]{color:#00e676;background:#00e6761a;border:1px solid rgba(0,230,118,.3)}.status-badge.InProgress[_ngcontent-%COMP%]{color:var(--gang-secondary);background:#448aff1a;border:1px solid rgba(68,138,255,.3);animation:_ngcontent-%COMP%_pulse-border 2s infinite}.description[_ngcontent-%COMP%]{font-size:.9rem;color:var(--gang-text-muted);margin-bottom:1.5rem;line-height:1.5;height:3rem;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.mission-details[_ngcontent-%COMP%]{background:#ffffff08;border-radius:8px;padding:1rem;margin-bottom:1.5rem}.mission-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:.5rem;font-size:.8rem}.mission-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.mission-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:var(--gang-text-muted);font-weight:500}.mission-details[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#fff;font-weight:600;text-transform:uppercase}.actions-group[_ngcontent-%COMP%]{margin-top:auto}.chief-actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.chief-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;min-width:80px}.gang-btn[_ngcontent-%COMP%]{background:var(--gang-gradient-main);color:#fff;border:none;border-radius:4px;font-weight:700;padding:10px 15px;cursor:pointer;font-family:Oxanium,sans-serif;font-size:.8rem;letter-spacing:1px;transition:all .3s;text-shadow:0 1px 2px rgba(0,0,0,.2)}.gang-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 5px 15px #7c4dff66}.gang-btn.secondary[_ngcontent-%COMP%]{background:transparent;border:1px solid var(--gang-secondary);color:var(--gang-secondary)}.gang-btn.secondary[_ngcontent-%COMP%]:hover{background:#448aff1a}.gang-btn.danger[_ngcontent-%COMP%]{background:transparent;border:1px solid #ff1744;color:#ff1744}.gang-btn.danger[_ngcontent-%COMP%]:hover{background:#ff17441a;box-shadow:0 5px 15px #ff174433}.gang-btn.sm[_ngcontent-%COMP%]{padding:6px 12px;font-size:.7rem}.gang-btn.full-width[_ngcontent-%COMP%]{width:100%}.loading-state[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{text-align:center;padding:4rem;color:var(--gang-text-muted);background:var(--gang-surface);border-radius:16px;border:1px dashed var(--gang-border);text-transform:uppercase;letter-spacing:2px}.fab-add-btn[_ngcontent-%COMP%]{position:fixed;bottom:2rem;right:2rem;width:4rem;height:4rem;border-radius:50%;background:var(--gang-gradient-accent);color:#000;font-size:2.5rem;border:none;cursor:pointer;box-shadow:0 0 20px #ffd74066;display:flex;align-items:center;justify-content:center;transition:all .3s;z-index:1000;font-weight:300}.fab-add-btn[_ngcontent-%COMP%]:hover{transform:rotate(90deg) scale(1.1);box-shadow:0 0 30px #ffd74099}@keyframes _ngcontent-%COMP%_pulse-border{0%{box-shadow:0 0 #7c4dff66}70%{box-shadow:0 0 0 10px #7c4dff00}to{box-shadow:0 0 #7c4dff00}}']})};export{j as MyMissions};
