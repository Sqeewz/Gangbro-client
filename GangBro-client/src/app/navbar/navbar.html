<div class="gang-sidebar">
    <div class="sidebar-top">
        <span class="gang-brand" routerLink="/" routerLinkActive="gang-active" [routerLinkActiveOptions]="{exact:true}">
            <img src="/logo.ico" alt="Logo" class="brand-logo">
            <span class="brand-text">GANG <span class="highlight">BRO</span></span>
        </span>

        @if (display_name()) {
        <div class="user-profile-top" [matMenuTriggerFor]="profileMenu">
            <img [src]="avatar_url() || 'assets/default-avatar.png'" class="user-avatar shadow-glow" alt="User">
            <div class="profile-info">
                <span class="user-name">{{ display_name() }}</span>
                <span class="user-status">OPERATIVE ONLINE</span>
            </div>
        </div>
        }
    </div>

    <div class="sidebar-center">
        <div class="nav-links">
            <button mat-button class="nav-btn" routerLink="/missions" routerLinkActive="gang-active"
                matTooltip="MISSIONS">
                <mat-icon>explore</mat-icon>
                <span class="btn-text">MISSIONS</span>
            </button>
            <button mat-button class="nav-btn" routerLink="/about-us" routerLinkActive="gang-active"
                matTooltip="ABOUT US">
                <mat-icon>info</mat-icon>
                <span class="btn-text">ABOUT US</span>
            </button>
            <button mat-button class="nav-btn" routerLink="/setting" routerLinkActive="gang-active"
                matTooltip="SETTINGS">
                <mat-icon>settings</mat-icon>
                <span class="btn-text">SETTINGS</span>
            </button>
        </div>
    </div>

    <div class="sidebar-bottom">
        <div class="user-actions">
            <button mat-icon-button class="notif-btn" [matMenuTriggerFor]="notifMenu" matTooltip="NOTIFICATIONS">
                <mat-icon [matBadge]="unreadCount()" [matBadgeHidden]="unreadCount() === 0" matBadgeColor="warn"
                    [class.has-unread]="unreadCount() > 0">
                    notifications
                </mat-icon>
            </button>
            <button mat-icon-button class="cache-btn" (click)="clearCache()" matTooltip="PURGE CACHE">
                <mat-icon>delete_sweep</mat-icon>
            </button>
        </div>
    </div>

    <mat-menu #profileMenu="matMenu" class="gang-menu">
        <div class="menu-user-info">
            <span class="menu-name">{{ display_name() }}</span>
        </div>
        <button mat-menu-item routerLink="/profile">
            <mat-icon>account_circle</mat-icon>
            <span>PROFILE</span>
        </button>
        <button mat-menu-item routerLink="/profile" [queryParams]="{tab: 'active'}">
            <mat-icon>assignment</mat-icon>
            <span>MY MISSION</span>
        </button>
        <hr class="menu-divider">
        <button mat-menu-item (click)="logout()" class="logout-item">
            <mat-icon>logout</mat-icon>
            <span>LOGOUT SYSTEM</span>
        </button>
    </mat-menu>

    <!-- Notifications Menu -->

    <mat-menu #notifMenu="matMenu" class="gang-notif-menu">
        <div class="notif-header">
            <h3>NOTIFICATIONS</h3>
            <button mat-button class="clear-btn" (click)="clearNotifications(); $event.stopPropagation()">CLEAR
                ALL</button>
        </div>
        <div class="notif-list" (click)="$event.stopPropagation()">
            @for (notif of notifications(); track notif.id) {
            <div class="notif-item" [class.unread]="!notif.read" [class]="notif.type">
                <div class="notif-content">
                    <div class="notif-title">{{notif.title}}</div>
                    <div class="notif-msg">{{notif.message}}</div>
                    <div class="notif-time">{{notif.time | date:'shortTime'}}</div>
                </div>
            </div>
            } @empty {
            <div class="empty-notif">NO NEW UPDATES</div>
            }
        </div>
    </mat-menu>
</div>