<div class="gang-sidebar">
    <div class="sidebar-top">
        <span class="gang-brand" routerLink="/" routerLinkActive="gang-active" [routerLinkActiveOptions]="{exact:true}">
            <img src="/logo.ico" alt="Logo" class="brand-logo">
            <span class="brand-text">GANG <span class="highlight">BRO</span></span>
        </span>

        @if (display_name()) {
        <div class="user-profile-wrapper">
            <div class="user-profile-top" (click)="toggleProfileSub()">
                <img [src]="avatar_url() || 'assets/default-avatar.png'" class="user-avatar shadow-glow" alt="User">
                <div class="profile-info">
                    <div class="user-details">
                        <span class="user-name">{{ display_name() }}</span>
                        <span class="user-status">OPERATIVE ONLINE</span>
                    </div>
                    <mat-icon class="expand-icon">{{ isProfileExpanded() ? 'expand_less' : 'expand_more' }}</mat-icon>
                </div>
            </div>

            <div class="profile-submenu" [class.expanded]="isProfileExpanded()">
                <button mat-button class="nav-btn sub-item" routerLink="/profile" routerLinkActive="gang-active">
                    <mat-icon>account_circle</mat-icon>
                    <span class="btn-text">PROFILE</span>
                </button>
                <button mat-button class="nav-btn sub-item" routerLink="/my-mission" routerLinkActive="gang-active">
                    <mat-icon>assignment</mat-icon>
                    <span class="btn-text">MY MISSION</span>
                </button>
                <button mat-button class="nav-btn sub-item logout-item-inline" (click)="logout()">
                    <mat-icon>logout</mat-icon>
                    <span class="btn-text">LOGOUT SYSTEM</span>
                </button>
            </div>
        </div>
        }
    </div>

    <div class="sidebar-center">
        <div class="nav-links">
            <button mat-button class="nav-btn" routerLink="/missions" routerLinkActive="gang-active"
                matTooltip="MISSIONS">
                <mat-icon>explore</mat-icon>
                <span class="btn-text">MISSIONS</span>
            </button>
            <button mat-button class="nav-btn" routerLink="/about-us" routerLinkActive="gang-active"
                matTooltip="ABOUT US">
                <mat-icon>info</mat-icon>
                <span class="btn-text">ABOUT US</span>
            </button>
            <button mat-button class="nav-btn" routerLink="/setting" routerLinkActive="gang-active"
                matTooltip="SETTINGS">
                <mat-icon>settings</mat-icon>
                <span class="btn-text">SETTINGS</span>
            </button>
        </div>
    </div>

    <div class="sidebar-bottom">
        <div class="user-actions">
            <button mat-icon-button class="notif-btn" [matMenuTriggerFor]="notifMenu" matTooltip="NOTIFICATIONS">
                <mat-icon [matBadge]="unreadCount()" [matBadgeHidden]="unreadCount() === 0" matBadgeColor="warn"
                    [class.has-unread]="unreadCount() > 0">
                    notifications
                </mat-icon>
            </button>
            <button mat-icon-button class="cache-btn" (click)="clearCache()" matTooltip="PURGE CACHE">
                <mat-icon>delete_sweep</mat-icon>
            </button>
        </div>
    </div>

    <!-- Notifications Menu -->

    <mat-menu #notifMenu="matMenu" class="gang-notif-menu">
        <div class="notif-header">
            <h3>NOTIFICATIONS</h3>
            <button mat-button class="clear-btn" (click)="clearNotifications(); $event.stopPropagation()">CLEAR
                ALL</button>
        </div>
        <div class="notif-list" (click)="$event.stopPropagation()">
            @for (notif of notifications(); track notif.id) {
            <div class="notif-item" [class.unread]="!notif.read" [class]="notif.type">
                <div class="notif-content">
                    <div class="notif-title">{{notif.title}}</div>
                    <div class="notif-msg">{{notif.message}}</div>
                    <div class="notif-time">{{notif.time | date:'shortTime'}}</div>
                </div>
            </div>
            } @empty {
            <div class="empty-notif">NO NEW UPDATES</div>
            }
        </div>
    </mat-menu>
</div>